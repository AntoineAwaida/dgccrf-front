{"ast":null,"code":"var _jsxFileName = \"/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/trame/index.js\";\nimport React from 'react';\nimport Avant from './avant.container';\nimport Pendant from './pendant.container';\nimport Apres from './après.container';\nimport SwipeableViews from 'react-swipeable-views';\nimport './visite.css';\nimport PouchDbService from '../../../services/index';\nimport MyActivityIndicator from '../../../components/myActivityIndicator.component';\nimport PropTypes from 'prop-types';\nimport EditComponent from './edit';\n\nclass Trame extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      activeIndex: 0,\n      isLoading: true,\n      trame: [],\n      visite: null,\n      rev: null\n    };\n    this.getActiveIndex = this.getActiveIndex.bind(this);\n    this.setStatus = this.setStatus.bind(this);\n    this.closeEdit = this.closeEdit.bind(this);\n  }\n\n  async getTrame() {\n    const visite = await PouchDbService.services.visite.getVisiteById(this.props.match.params.id);\n    this.setState({\n      visite: visite,\n      rev: visite._rev,\n      trame: visite.trame,\n      isLoading: false\n    });\n  }\n\n  componentDidMount() {\n    this.getTrame();\n  }\n\n  async closeEdit() {\n    await this.getTrame();\n    this.props.close();\n  }\n\n  setStatus(newstatus, index) {\n    let trame = this.state.trame;\n\n    if (this.state.activeIndex === 0) {\n      trame.trameAvant[index].status = newstatus;\n      this.setState({\n        trame\n      });\n    } else if (this.state.activeIndex === 1) {\n      trame.tramePendant[index].status = newstatus;\n      this.setState({\n        trame\n      });\n    } else {\n      trame.trameAprès[index].status = newstatus;\n      this.setState({\n        trame\n      });\n    }\n\n    PouchDbService.services.visite.updateTrame(this.state.visite, this.state.rev, trame).then(res => {\n      this.setState({\n        rev: res.rev\n      });\n    });\n  }\n\n  getActiveIndex(e) {\n    this.setState({\n      activeIndex: e\n    });\n  }\n\n  render() {\n    return this.state.isLoading ? React.createElement(MyActivityIndicator, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        width: '100%',\n        height: '100%',\n        justifyContent: 'center',\n        overflow: 'hidden'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, this.props.editMode ? React.createElement(EditComponent, Object.assign({\n      visite: this.state.visite,\n      setStatus: this.setStatus,\n      isLoading: this.state.isLoading,\n      trame: this.state.trame,\n      closeEdit: this.closeEdit\n    }, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    })) : React.createElement(SwipeableViews, {\n      style: {\n        width: '100%'\n      },\n      className: \"hidescrollbar\",\n      index: this.props.index,\n      onChangeIndex: this.props.handleChangeIndex,\n      slideClassName: \"hidescrollbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(Avant, Object.assign({\n      visite: this.state.visite,\n      setStatus: this.setStatus,\n      isLoading: this.state.isLoading,\n      trame: this.state.trame,\n      closeEdit: this.closeEdit\n    }, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    })), React.createElement(Pendant, Object.assign({\n      visite: this.state.visite,\n      setStatus: this.setStatus,\n      isLoading: this.state.isLoading,\n      trame: this.state.trame,\n      closeEdit: this.closeEdit\n    }, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    })), React.createElement(Apres, Object.assign({\n      visite: this.state.visite,\n      setStatus: this.setStatus,\n      isLoading: this.state.isLoading,\n      trame: this.state.trame,\n      closeEdit: this.closeEdit\n    }, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nTrame.propTypes = {\n  match: PropTypes.any,\n  handleChangeIndex: PropTypes.func,\n  index: PropTypes.number\n};\nexport default Trame;","map":{"version":3,"sources":["/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/trame/index.js"],"names":["React","Avant","Pendant","Apres","SwipeableViews","PouchDbService","MyActivityIndicator","PropTypes","EditComponent","Trame","Component","constructor","props","context","state","activeIndex","isLoading","trame","visite","rev","getActiveIndex","bind","setStatus","closeEdit","getTrame","services","getVisiteById","match","params","id","setState","_rev","componentDidMount","close","newstatus","index","trameAvant","status","tramePendant","trameAprès","updateTrame","then","res","e","render","display","width","height","justifyContent","overflow","editMode","handleChangeIndex","propTypes","any","func","number"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport Avant from './avant.container';\nimport Pendant from './pendant.container';\nimport Apres from './après.container';\nimport SwipeableViews from 'react-swipeable-views';\n\nimport './visite.css';\nimport PouchDbService from '../../../services/index';\nimport MyActivityIndicator from '../../../components/myActivityIndicator.component';\n\nimport PropTypes from 'prop-types';\nimport EditComponent from './edit';\n\nclass Trame extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      activeIndex: 0,\n      isLoading: true,\n      trame: [],\n      visite: null,\n      rev: null\n    };\n    this.getActiveIndex = this.getActiveIndex.bind(this);\n    this.setStatus = this.setStatus.bind(this);\n    this.closeEdit = this.closeEdit.bind(this);\n  }\n\n  async getTrame() {\n    const visite = await PouchDbService.services.visite.getVisiteById(\n      this.props.match.params.id\n    );\n\n    this.setState({\n      visite: visite,\n      rev: visite._rev,\n      trame: visite.trame,\n      isLoading: false\n    });\n  }\n\n  componentDidMount() {\n    this.getTrame();\n  }\n\n  async closeEdit() {\n    await this.getTrame();\n    this.props.close();\n  }\n\n  setStatus(newstatus, index) {\n    let trame = this.state.trame;\n    if (this.state.activeIndex === 0) {\n      trame.trameAvant[index].status = newstatus;\n      this.setState({\n        trame\n      });\n    } else if (this.state.activeIndex === 1) {\n      trame.tramePendant[index].status = newstatus;\n      this.setState({\n        trame\n      });\n    } else {\n      trame.trameAprès[index].status = newstatus;\n      this.setState({\n        trame\n      });\n    }\n    PouchDbService.services.visite\n      .updateTrame(this.state.visite, this.state.rev, trame)\n      .then(res => {\n        this.setState({ rev: res.rev });\n      });\n  }\n\n  getActiveIndex(e) {\n    this.setState({ activeIndex: e });\n  }\n\n  render() {\n    return this.state.isLoading ? (\n      <MyActivityIndicator />\n    ) : (\n      <div\n        style={{\n          display: 'flex',\n          width: '100%',\n          height: '100%',\n          justifyContent: 'center',\n          overflow: 'hidden'\n        }}\n      >\n        {this.props.editMode ? (\n          <EditComponent\n            visite={this.state.visite}\n            setStatus={this.setStatus}\n            isLoading={this.state.isLoading}\n            trame={this.state.trame}\n            closeEdit={this.closeEdit}\n            {...this.props}\n          />\n        ) : (\n          <SwipeableViews\n            style={{ width: '100%' }}\n            className=\"hidescrollbar\"\n            index={this.props.index}\n            onChangeIndex={this.props.handleChangeIndex}\n            slideClassName=\"hidescrollbar\"\n          >\n            <Avant\n              visite={this.state.visite}\n              setStatus={this.setStatus}\n              isLoading={this.state.isLoading}\n              trame={this.state.trame}\n              closeEdit={this.closeEdit}\n              {...this.props}\n            />\n            <Pendant\n              visite={this.state.visite}\n              setStatus={this.setStatus}\n              isLoading={this.state.isLoading}\n              trame={this.state.trame}\n              closeEdit={this.closeEdit}\n              {...this.props}\n            />\n            <Apres\n              visite={this.state.visite}\n              setStatus={this.setStatus}\n              isLoading={this.state.isLoading}\n              trame={this.state.trame}\n              closeEdit={this.closeEdit}\n              {...this.props}\n            />\n          </SwipeableViews>\n        )}\n      </div>\n    );\n  }\n}\n\nTrame.propTypes = {\n  match: PropTypes.any,\n  handleChangeIndex: PropTypes.func,\n  index: PropTypes.number\n};\n\nexport default Trame;\n"]},"metadata":{},"sourceType":"module"}