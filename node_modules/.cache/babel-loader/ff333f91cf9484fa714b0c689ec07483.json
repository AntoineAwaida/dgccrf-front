{"ast":null,"code":"var _jsxFileName = \"/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/index.js\";\nimport React from 'react';\nimport TrameComponent from './trame';\nimport { Container, Icon, Button, Responsive } from 'semantic-ui-react';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport { EventEmitter } from 'events';\nimport FileNavigationComponent from '../fileNavigation';\nimport Photo from './photo/photo';\nimport Documents from './documents/documents.container';\nimport { PropTypes } from 'prop-types';\nimport { changeNameOfPage, changeBackUrl, changeActivePage } from '../navbar/actions';\nimport { connect } from 'react-redux';\nimport './trame/visite.css';\nimport PouchdbServices from '../../services';\nlet visitesService = PouchdbServices.services.visite;\n\nfunction mapStateToProps(state) {\n  return {\n    backUrl: state.navbarReducer.activePages.mesDossiers,\n    oldBackUrl: state.navbarReducer.backPage\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    changeNameOfPage: newName => dispatch(changeNameOfPage(newName)),\n    changeBackUrl: value => dispatch(changeBackUrl(value)),\n    changeActivePage: value => dispatch(changeActivePage('mesDossiers', value))\n  };\n}\n\nclass Visite extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.handleChangeIndex = value => {\n      this.setState({\n        activeIndex: value\n      });\n    };\n\n    this.handleChange = (event, value) => {\n      this.setState({\n        activeIndex: value\n      });\n    };\n\n    this.setActiveTab = index => {\n      this.setState({\n        activeTab: index\n      });\n    };\n\n    this.exportToSora = async () => {\n      if (window.confirm('Êtes-vous sur de vouloir exporter cette visite dans SORA.\\n Vous ne pourrez plus modifier la visite dans SESAM et vous perdrez la trame liée à la visite.')) {\n        await visitesService.exportToSora(this.props.match.params.id);\n        this.props.history.goBack();\n      }\n    };\n\n    this._emitter = new EventEmitter();\n    this.state = {\n      activeIndex: 0,\n      activeTab: 0,\n      editMode: false\n    };\n    this.handleChangeIndex = this.handleChangeIndex.bind(this);\n    this.setActiveTab = this.setActiveTab.bind(this);\n    this.closeEdit = this.closeEdit.bind(this);\n    this.exportToSora = this.exportToSora.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.changeNameOfPage('Visite ' + this.props.match.params.id);\n\n    const newBackUrl = (backUrl, oldBackUrl) => {\n      if (backUrl.includes('/dossier')) {\n        return backUrl;\n      }\n\n      if (oldBackUrl.includes('/dossier')) {\n        return oldBackUrl;\n      } else {\n        return '/mes-dossiers';\n      }\n    };\n\n    this.props.changeBackUrl(newBackUrl(this.props.backUrl, this.props.oldBackUrl));\n    this.props.changeActivePage('/visite/' + this.props.match.params.id);\n  }\n\n  closeEdit() {\n    this.setState({\n      editMode: false\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"hidescrollbar\",\n      style: {\n        display: 'flex',\n        height: '100%',\n        backgroundColor: '#f2f2f2',\n        overflow: 'hidden'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        width: '100%',\n        justifyContent: 'center',\n        textAlign: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(Container, {\n      style: {\n        height: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, this.state.activeTab === 0 ? React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        overflow: 'auto',\n        height: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        position: 'fixed',\n        zIndex: 10,\n        width: '100%',\n        backgroundColor: '#f2f2f2',\n        display: 'flex',\n        justifyContent: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(Responsive, {\n      minWidth: 540,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(Button, {\n      icon: true,\n      style: {\n        position: 'absolute',\n        left: 10,\n        top: 10\n      },\n      labelPosition: \"left\",\n      onClick: () => this.setState({\n        editMode: true\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"pencil\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), \"Editer\")), React.createElement(Responsive, {\n      maxWidth: 539,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(Button, {\n      icon: true,\n      disabled: this.state.editMode,\n      style: {\n        position: 'absolute',\n        left: 10,\n        top: 10\n      },\n      onClick: () => this.setState({\n        editMode: true\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"pencil\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }))), React.createElement(Responsive, {\n      minWidth: 540,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(Button, {\n      icon: true,\n      style: {\n        position: 'absolute',\n        right: 10,\n        top: 10\n      },\n      labelPosition: \"left\",\n      onClick: this.exportToSora,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"share square\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }), \"Exporter\")), React.createElement(Responsive, {\n      maxWidth: 539,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(Button, {\n      icon: true,\n      style: {\n        position: 'absolute',\n        right: 10,\n        top: 10\n      },\n      onClick: this.exportToSora,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"share square\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }))), React.createElement(Tabs, {\n      value: this.state.activeIndex,\n      fullWidth: true,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(Tab, {\n      label: \"Avant\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }), React.createElement(Tab, {\n      label: \"Pendant\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }), React.createElement(Tab, {\n      label: \"Apr\\xE8s\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      style: {\n        flex: 10,\n        overflowY: 'auto',\n        marginTop: 80,\n        paddingBottom: 105,\n        width: '100%'\n      },\n      className: \"hidescrollbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, React.createElement(TrameComponent, Object.assign({\n      editMode: this.state.editMode,\n      close: this.closeEdit\n    }, this.props, {\n      index: this.state.activeIndex,\n      handleChangeIndex: this.handleChangeIndex,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    })))) : this.state.activeTab === 1 ? React.createElement(Photo, {\n      setActiveTab: this.setActiveTab,\n      visiteid: parseInt(this.props.match.params.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, React.createElement(Documents, Object.assign({}, this.props, {\n      visiteid: parseInt(this.props.match.params.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    })))), React.createElement(FileNavigationComponent, {\n      setActiveTab: this.setActiveTab,\n      activeItem: this.state.activeTab,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    })));\n  }\n\n}\n\nVisite.propTypes = {\n  history: PropTypes.any.isRequired,\n  changeNameOfPage: PropTypes.func.isRequired,\n  changeBackUrl: PropTypes.func.isRequired,\n  changeActivePage: PropTypes.func.isRequired,\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      id: PropTypes.string\n    })\n  }),\n  backUrl: PropTypes.string.isRequired,\n  oldBackUrl: PropTypes.string.isRequired\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Visite);","map":{"version":3,"sources":["/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/index.js"],"names":["React","TrameComponent","Container","Icon","Button","Responsive","Tabs","Tab","EventEmitter","FileNavigationComponent","Photo","Documents","PropTypes","changeNameOfPage","changeBackUrl","changeActivePage","connect","PouchdbServices","visitesService","services","visite","mapStateToProps","state","backUrl","navbarReducer","activePages","mesDossiers","oldBackUrl","backPage","mapDispatchToProps","dispatch","newName","value","Visite","Component","constructor","props","context","handleChangeIndex","setState","activeIndex","handleChange","event","setActiveTab","index","activeTab","exportToSora","window","confirm","match","params","id","history","goBack","_emitter","editMode","bind","closeEdit","componentDidMount","newBackUrl","includes","render","display","height","backgroundColor","overflow","width","justifyContent","textAlign","flexDirection","alignItems","position","zIndex","left","top","right","flex","overflowY","marginTop","paddingBottom","parseInt","propTypes","any","isRequired","func","shape","string"],"mappings":"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","sourcesContent":["import React from 'react';\nimport TrameComponent from './trame';\nimport { Container, Icon, Button, Responsive } from 'semantic-ui-react';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport { EventEmitter } from 'events';\nimport FileNavigationComponent from '../fileNavigation';\nimport Photo from './photo/photo';\nimport Documents from './documents/documents.container';\nimport { PropTypes } from 'prop-types';\nimport {\n  changeNameOfPage,\n  changeBackUrl,\n  changeActivePage\n} from '../navbar/actions';\nimport { connect } from 'react-redux';\nimport './trame/visite.css';\nimport PouchdbServices from '../../services';\nlet visitesService = PouchdbServices.services.visite;\n\nfunction mapStateToProps(state) {\n  return {\n    backUrl: state.navbarReducer.activePages.mesDossiers,\n    oldBackUrl: state.navbarReducer.backPage\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    changeNameOfPage: newName => dispatch(changeNameOfPage(newName)),\n    changeBackUrl: value => dispatch(changeBackUrl(value)),\n    changeActivePage: value => dispatch(changeActivePage('mesDossiers', value))\n  };\n}\n\nclass Visite extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this._emitter = new EventEmitter();\n    this.state = {\n      activeIndex: 0,\n      activeTab: 0,\n      editMode: false\n    };\n    this.handleChangeIndex = this.handleChangeIndex.bind(this);\n    this.setActiveTab = this.setActiveTab.bind(this);\n    this.closeEdit = this.closeEdit.bind(this);\n    this.exportToSora = this.exportToSora.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.changeNameOfPage('Visite ' + this.props.match.params.id);\n    const newBackUrl = (backUrl, oldBackUrl) => {\n      if (backUrl.includes('/dossier')) {\n        return backUrl;\n      }\n      if (oldBackUrl.includes('/dossier')) {\n        return oldBackUrl;\n      } else {\n        return '/mes-dossiers';\n      }\n    };\n    this.props.changeBackUrl(\n      newBackUrl(this.props.backUrl, this.props.oldBackUrl)\n    );\n    this.props.changeActivePage('/visite/' + this.props.match.params.id);\n  }\n\n  closeEdit() {\n    this.setState({ editMode: false });\n  }\n\n  handleChangeIndex = value => {\n    this.setState({\n      activeIndex: value\n    });\n  };\n\n  handleChange = (event, value) => {\n    this.setState({\n      activeIndex: value\n    });\n  };\n\n  setActiveTab = index => {\n    this.setState({ activeTab: index });\n  };\n\n  exportToSora = async () => {\n    if (\n      window.confirm(\n        'Êtes-vous sur de vouloir exporter cette visite dans SORA.\\n Vous ne pourrez plus modifier la visite dans SESAM et vous perdrez la trame liée à la visite.'\n      )\n    ) {\n      await visitesService.exportToSora(this.props.match.params.id);\n      this.props.history.goBack();\n    }\n  };\n\n  render() {\n    return (\n      <div\n        className=\"hidescrollbar\"\n        style={{\n          display: 'flex',\n          height: '100%',\n\n          backgroundColor: '#f2f2f2',\n          overflow: 'hidden'\n        }}\n      >\n        <div\n          style={{\n            width: '100%',\n            justifyContent: 'center',\n            textAlign: 'center'\n          }}\n        >\n          <Container style={{ height: '100%' }}>\n            {this.state.activeTab === 0 ? (\n              <div\n                style={{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  alignItems: 'center',\n                  overflow: 'auto',\n                  height: '100%'\n                }}\n              >\n                <div\n                  style={{\n                    position: 'fixed',\n                    zIndex: 10,\n                    width: '100%',\n                    backgroundColor: '#f2f2f2',\n                    display: 'flex',\n                    justifyContent: 'center'\n                  }}\n                >\n                  <Responsive minWidth={540}>\n                    <Button\n                      icon\n                      style={{ position: 'absolute', left: 10, top: 10 }}\n                      labelPosition=\"left\"\n                      onClick={() => this.setState({ editMode: true })}\n                    >\n                      <Icon name=\"pencil\"></Icon>\n                      Editer\n                    </Button>\n                  </Responsive>\n                  <Responsive maxWidth={539}>\n                    <Button\n                      icon\n                      disabled={this.state.editMode}\n                      style={{ position: 'absolute', left: 10, top: 10 }}\n                      onClick={() => this.setState({ editMode: true })}\n                    >\n                      <Icon name=\"pencil\"></Icon>\n                    </Button>\n                  </Responsive>\n\n                  {/* <Button\n                    icon\n                    disabled={this.state.editMode}\n                    style={{ position: 'absolute', left: 10, top: 10 }}\n                    labelPosition=\"left\"\n                    content={<Responsive minWidth={540}>Editer</Responsive>}\n                    onClick={() => this.setState({ editMode: true })}\n                  >\n                    <Icon name=\"pencil\"></Icon>\n                  </Button> */}\n                  <Responsive minWidth={540}>\n                    <Button\n                      icon\n                      style={{ position: 'absolute', right: 10, top: 10 }}\n                      labelPosition=\"left\"\n                      onClick={this.exportToSora}\n                    >\n                      <Icon name=\"share square\"></Icon>\n                      Exporter\n                    </Button>\n                  </Responsive>\n                  <Responsive maxWidth={539}>\n                    <Button\n                      icon\n                      style={{ position: 'absolute', right: 10, top: 10 }}\n                      onClick={this.exportToSora}\n                    >\n                      <Icon name=\"share square\"></Icon>\n                    </Button>\n                  </Responsive>\n\n                  <Tabs\n                    value={this.state.activeIndex}\n                    fullWidth\n                    onChange={this.handleChange}\n                  >\n                    <Tab label=\"Avant\" />\n                    <Tab label=\"Pendant\" />\n                    <Tab label=\"Après\" />\n                  </Tabs>\n                </div>\n                <div\n                  style={{\n                    flex: 10,\n                    overflowY: 'auto',\n                    marginTop: 80,\n                    paddingBottom: 105,\n                    width: '100%'\n                  }}\n                  className=\"hidescrollbar\"\n                >\n                  <TrameComponent\n                    editMode={this.state.editMode}\n                    close={this.closeEdit}\n                    {...this.props}\n                    index={this.state.activeIndex}\n                    handleChangeIndex={this.handleChangeIndex}\n                  />\n                </div>\n              </div>\n            ) : this.state.activeTab === 1 ? (\n              <Photo\n                setActiveTab={this.setActiveTab}\n                visiteid={parseInt(this.props.match.params.id)}\n              />\n            ) : (\n              <div>\n                <Documents\n                  {...this.props}\n                  visiteid={parseInt(this.props.match.params.id)}\n                />\n              </div>\n            )}\n          </Container>\n          <FileNavigationComponent\n            setActiveTab={this.setActiveTab}\n            activeItem={this.state.activeTab}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nVisite.propTypes = {\n  history: PropTypes.any.isRequired,\n  changeNameOfPage: PropTypes.func.isRequired,\n  changeBackUrl: PropTypes.func.isRequired,\n  changeActivePage: PropTypes.func.isRequired,\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      id: PropTypes.string\n    })\n  }),\n  backUrl: PropTypes.string.isRequired,\n  oldBackUrl: PropTypes.string.isRequired\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Visite);\n"]},"metadata":{},"sourceType":"module"}