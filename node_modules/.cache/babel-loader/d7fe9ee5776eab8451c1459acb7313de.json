{"ast":null,"code":"var _jsxFileName = \"/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/dossier/documents.container.js\";\nimport React, { Component } from 'react';\nimport { Button, Icon, Header, Modal } from 'semantic-ui-react';\nimport documentsService from '../../services/documents.service';\nimport MyActivityIndicator from '../../components/myActivityIndicator.component';\nimport DocumentModal from '../../components/documentModal.component';\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = () => resolve(reader.result);\n\n    reader.onerror = error => reject(error);\n  });\n}\n\nexport default class Documents extends Component {\n  constructor(props, context) {\n    super(props, context);\n    this.fileInputRef = React.createRef();\n\n    this.fileChange = e => {\n      this.setState({\n        file: e.target.files[0]\n      }, async () => {\n        try {\n          const file64 = await getBase64(this.state.file);\n          await documentsService.postDocument(file64, this.state.file.type, this.state.file.name);\n          console.log('File sent!'); //ne pas oublier de resize l'image si c'est une image...\n        } catch (e) {\n          console.log('Error while sending file.');\n        }\n      });\n    };\n\n    this.state = {\n      file: null,\n      documents: null,\n      modal: false,\n      documentSelected: null\n    };\n    this.reader = new FileReader();\n  }\n\n  getColor(type) {\n    if (type.includes('image')) {\n      return ['blue', 'file image'];\n    } else if (type.includes('pdf')) {\n      return ['red', 'file pdf'];\n    } else if (type.includes('sheet')) {\n      return ['green', 'file excel'];\n    } else {\n      return ['grey', 'file'];\n    }\n  }\n\n  loadDocuments(documents) {\n    this.setState({\n      documents\n    });\n  }\n\n  showModal(document) {\n    console.log(document);\n    this.setState({\n      modal: true,\n      documentSelected: document\n    });\n  }\n\n  componentDidMount() {\n    documentsService.getAllDocs().then(res => {\n      this.loadDocuments(res);\n    });\n    documentsService.onChanges(() => documentsService.getAllDocs().then(res => this.loadDocuments(res)));\n  }\n\n  render() {\n    const documents = this.state.documents;\n    console.log(documents);\n    return React.createElement(React.Fragment, null, this.state.modal && this.state.documentSelected && React.createElement(DocumentModal, {\n      document: this.state.documentSelected,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }), React.createElement(Button, {\n      content: \"Ajouter un fichier\",\n      labelPosition: \"left\",\n      icon: \"file\",\n      onClick: () => this.fileInputRef.current.click(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      ref: this.fileInputRef,\n      type: \"file\",\n      hidden: true,\n      onChange: this.fileChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }), documents ? React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexWrap: 'wrap'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, documents.map((document, i) => React.createElement(\"div\", {\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(Button, {\n      onClick: () => this.showModal(document),\n      style: {\n        margin: '3em',\n        marginBottom: '1.5em',\n        display: 'flex',\n        height: '15em',\n        width: '15em',\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      basic: true,\n      color: this.getColor(document.type)[0],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        fontSize: '2em'\n      },\n      name: this.getColor(document.type)[1],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    })), React.createElement(Header, {\n      as: \"h4\",\n      color: this.getColor(document.type)[0],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, document.name)))) : React.createElement(MyActivityIndicator, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/dossier/documents.container.js"],"names":["React","Component","Button","Icon","Header","Modal","documentsService","MyActivityIndicator","DocumentModal","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","Documents","constructor","props","context","fileInputRef","createRef","fileChange","e","setState","target","files","file64","state","postDocument","type","name","console","log","documents","modal","documentSelected","getColor","includes","loadDocuments","showModal","document","componentDidMount","getAllDocs","then","res","onChanges","render","current","click","display","flexWrap","map","i","margin","marginBottom","height","width","justifyContent","alignItems","fontSize"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Button, Icon, Header, Modal } from 'semantic-ui-react';\nimport documentsService from '../../services/documents.service';\nimport MyActivityIndicator from '../../components/myActivityIndicator.component';\nimport DocumentModal from '../../components/documentModal.component';\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = error => reject(error);\n  });\n}\n\nexport default class Documents extends Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      file: null,\n      documents: null,\n      modal: false,\n      documentSelected: null\n    };\n    this.reader = new FileReader();\n  }\n\n  getColor(type) {\n    if (type.includes('image')) {\n      return ['blue', 'file image'];\n    } else if (type.includes('pdf')) {\n      return ['red', 'file pdf'];\n    } else if (type.includes('sheet')) {\n      return ['green', 'file excel'];\n    } else {\n      return ['grey', 'file'];\n    }\n  }\n\n  loadDocuments(documents) {\n    this.setState({ documents });\n  }\n\n  showModal(document) {\n    console.log(document);\n    this.setState({\n      modal: true,\n      documentSelected: document\n    });\n  }\n\n  componentDidMount() {\n    documentsService.getAllDocs().then(res => {\n      this.loadDocuments(res);\n    });\n\n    documentsService.onChanges(() =>\n      documentsService.getAllDocs().then(res => this.loadDocuments(res))\n    );\n  }\n\n  fileInputRef = React.createRef();\n\n  fileChange = e => {\n    this.setState({ file: e.target.files[0] }, async () => {\n      try {\n        const file64 = await getBase64(this.state.file);\n        await documentsService.postDocument(\n          file64,\n          this.state.file.type,\n          this.state.file.name\n        );\n        console.log('File sent!');\n        //ne pas oublier de resize l'image si c'est une image...\n      } catch (e) {\n        console.log('Error while sending file.');\n      }\n    });\n  };\n\n  render() {\n    const { documents } = this.state;\n    console.log(documents);\n    return (\n      <>\n        {this.state.modal && this.state.documentSelected && (\n          <DocumentModal document={this.state.documentSelected} />\n        )}\n\n        <Button\n          content=\"Ajouter un fichier\"\n          labelPosition=\"left\"\n          icon=\"file\"\n          onClick={() => this.fileInputRef.current.click()}\n        />\n        <input\n          ref={this.fileInputRef}\n          type=\"file\"\n          hidden\n          onChange={this.fileChange}\n        />\n\n        {documents ? (\n          <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n            {documents.map((document, i) => (\n              <div key={i}>\n                <Button\n                  onClick={() => this.showModal(document)}\n                  style={{\n                    margin: '3em',\n                    marginBottom: '1.5em',\n                    display: 'flex',\n                    height: '15em',\n                    width: '15em',\n                    justifyContent: 'center',\n                    alignItems: 'center'\n                  }}\n                  basic\n                  color={this.getColor(document.type)[0]}\n                >\n                  <Icon\n                    style={{\n                      display: 'flex',\n                      justifyContent: 'center',\n                      alignItems: 'center',\n                      fontSize: '2em'\n                    }}\n                    name={this.getColor(document.type)[1]}\n                  ></Icon>\n                </Button>\n                <Header as=\"h4\" color={this.getColor(document.type)[0]}>\n                  {document.name}\n                </Header>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <MyActivityIndicator />\n        )}\n      </>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}