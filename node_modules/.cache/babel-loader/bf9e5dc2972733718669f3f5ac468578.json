{"ast":null,"code":"import _objectSpread from \"/Users/antoine/Documents/DGCCRF/dgccrf-front/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/antoine/Documents/DGCCRF/dgccrf-front/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/trame/edit.js\";\nimport React from 'react';\nimport { Container, Button, Icon, Responsive } from 'semantic-ui-react';\nimport { PropTypes } from 'prop-types';\nimport PouchDBServices from '../../../services/index';\nimport TrameList from '../../preferences/trame/trameList';\n\nclass EditComponent extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = (event, value) => {\n      this.setState({\n        activeIndex: value\n      });\n    };\n\n    this.handleChangeIndex = value => {\n      this.setState({\n        activeIndex: value\n      });\n    };\n\n    this.onDragEnd = result => {\n      const destination = result.destination,\n            source = result.source;\n\n      if (!destination) {\n        return;\n      }\n\n      if (destination.droppableId === source.droppableId && destination.index === source.index) {\n        return;\n      }\n\n      let taskList;\n      this.props.index === 0 ? taskList = this.state.taskListAvant : this.props.index === 1 ? taskList = this.state.taskListPendant : taskList = this.state.taskListAprès;\n      const res = Array.from(taskList);\n\n      const _res$splice = res.splice(result.source.index, 1),\n            _res$splice2 = _slicedToArray(_res$splice, 1),\n            removed = _res$splice2[0];\n\n      res.splice(result.destination.index, 0, removed);\n      this.props.index === 0 ? this.setState({\n        taskListAvant: res\n      }) : this.props.index === 1 ? this.setState({\n        taskListPendant: res\n      }) : this.setState({\n        taskListAprès: res\n      });\n    };\n\n    this.state = {\n      taskListAvant: this.props.trame.trameAvant,\n      taskListPendant: this.props.trame.tramePendant,\n      taskListAprès: this.props.trame.trameAprès,\n      activeIndex: 0,\n      index: this.calculateIndex(),\n      id: this.calculateIndex(),\n      isLoading: true,\n      _id: this.props.trame._id,\n      _rev: this.props.visite._rev,\n      locked: false\n    };\n    this.validateName = this.validateName.bind(this);\n    this.changeType = this.changeType.bind(this);\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleNameChange = this.handleNameChange.bind(this);\n    this.deleteTask = this.deleteTask.bind(this);\n    this.addDocument = this.addDocument.bind(this);\n    this.deleteDocument = this.deleteDocument.bind(this);\n    this.addForm = this.addForm.bind(this);\n  }\n\n  async saveTrame() {\n    if (window.confirm('Voulez-vous sauvegarder cette trame?')) {\n      try {\n        await PouchDBServices.services.visite.updateTrame(this.props.visite, this.state._rev, _objectSpread({}, this.props.trame, {\n          trameAvant: this.state.taskListAvant,\n          tramePendant: this.state.taskListPendant,\n          trameAprès: this.state.taskListAprès\n        }));\n        this.props.closeEdit();\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }\n\n  addForm(task) {\n    this.state.activeIndex === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        if (t == task) {\n          t.innerContent = 'form1&9';\n        }\n\n        return t;\n      })\n    }) : this.state.activeIndex === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        if (t == task) {\n          t.innerContent = 'form1&9';\n        }\n\n        return t;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        if (t == task) {\n          t.innerContent = 'form1&9';\n        }\n\n        return t;\n      })\n    });\n  }\n\n  calculateIndex() {\n    return Math.max(this.props.trame.trameAvant.length === 0 ? 0 : parseInt(Math.max.apply(Math, this.props.trame.trameAvant.map(function (o) {\n      return o.index;\n    }))), this.props.trame.tramePendant.length === 0 ? 0 : parseInt(Math.max.apply(Math, this.props.trame.tramePendant.map(function (o) {\n      return o.index;\n    }))), this.props.trame.trameAprès.length === 0 ? 0 : parseInt(Math.max.apply(Math, this.props.trame.trameAprès.map(function (o) {\n      return o.index;\n    })))) + 1;\n  }\n\n  deleteTask(task) {\n    this.props.index === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        return t != task;\n      })\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        return t != task;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        return t != task;\n      })\n    });\n  }\n\n  addDocument(task, file) {\n    this.props.index === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        if (t == task) {\n          t.innerContent = file;\n        }\n\n        return t;\n      })\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        if (t == task) {\n          t.innerContent = file;\n        }\n\n        return t;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        if (t == task) {\n          t.innerContent = file;\n        }\n\n        return t;\n      })\n    });\n  }\n\n  deleteDocument(task) {\n    this.props.index === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        if (t == task) {\n          t.innerContent = '';\n        }\n\n        return t;\n      })\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        if (t == task) {\n          t.innerContent = '';\n        }\n\n        return t;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        if (t == task) {\n          t.innerContent = '';\n        }\n\n        return t;\n      })\n    });\n  }\n\n  validateName(task, name) {\n    this.props.index === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        if (t == task) {\n          t.title = name;\n        }\n\n        return t;\n      })\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        if (t == task) {\n          t.title = name;\n        }\n\n        return t;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        if (t == task) {\n          t.title = name;\n        }\n\n        return t;\n      })\n    });\n  }\n\n  handleNameChange(e, data) {\n    this.setState({\n      trameName: data.value\n    });\n  }\n\n  handleTextChange(task, text) {\n    this.props.index === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        if (t == task) {\n          t.innerContent = text;\n        }\n\n        return t;\n      })\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        if (t == task) {\n          t.innerContent = text;\n        }\n\n        return t;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        if (t == task) {\n          t.innerContent = text;\n        }\n\n        return t;\n      })\n    });\n  }\n\n  changeType(task, type) {\n    this.props.index === 0 ? this.setState({\n      taskListAvant: this.state.taskListAvant.filter(t => {\n        if (t == task) {\n          t.type = type;\n        }\n\n        return t;\n      })\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: this.state.taskListPendant.filter(t => {\n        if (t == task) {\n          t.type = type;\n        }\n\n        return t;\n      })\n    }) : this.setState({\n      taskListAprès: this.state.taskListAprès.filter(t => {\n        if (t == task) {\n          t.type = type;\n        }\n\n        return t;\n      })\n    });\n  }\n\n  addTask() {\n    //de 3 types: basic, text, ou document.\n    this.props.index === 0 ? this.setState({\n      taskListAvant: [...this.state.taskListAvant, {\n        title: 'Nouvelle tâche' + this.state.index,\n        type: 'basic',\n        innerContent: '',\n        index: this.state.index,\n        id: this.state.id\n      }],\n      index: this.state.index + 1,\n      id: this.state.id + 1\n    }) : this.props.index === 1 ? this.setState({\n      taskListPendant: [...this.state.taskListPendant, {\n        title: 'Nouvelle tâche' + this.state.index,\n        type: 'basic',\n        innerContent: '',\n        index: this.state.index,\n        id: this.state.id\n      }],\n      index: this.state.index + 1,\n      id: this.state.id + 1\n    }) : this.setState({\n      taskListAprès: [...this.state.taskListAprès, {\n        title: 'Nouvelle tâche' + this.state.index,\n        type: 'basic',\n        innerContent: '',\n        index: this.state.index,\n        id: this.state.id\n      }],\n      index: this.state.index + 1,\n      id: this.state.id + 1\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"hidescrollbar\",\n      style: {\n        display: 'flex',\n        height: '100%',\n        width: '100%',\n        backgroundColor: '#f2f2f2',\n        overflow: 'hidden'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        width: '100%',\n        justifyContent: 'center',\n        textAlign: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409\n      },\n      __self: this\n    }, React.createElement(Container, {\n      style: {\n        height: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        overflow: 'hidden',\n        height: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        position: 'fixed',\n        zIndex: 10,\n        width: '100%',\n        backgroundColor: '#f2f2f2',\n        display: 'flex',\n        flexDirection: 'column',\n        padding: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 426\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'row'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438\n      },\n      __self: this\n    }, React.createElement(Responsive, {\n      minWidth: 400,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        flex: 0.3\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: {\n        flex: 1,\n        display: 'flex',\n        justifyContent: 'flex-end'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442\n      },\n      __self: this\n    }, React.createElement(Button, {\n      style: {\n        marginLeft: 5\n      },\n      color: \"teal\",\n      icon: true,\n      onClick: () => this.addTask(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"plus\",\n      color: \"white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      style: {\n        flex: 1,\n        justifyContent: 'flex-end',\n        display: 'flex'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458\n      },\n      __self: this\n    }, React.createElement(Button, {\n      icon: true,\n      onClick: () => this.setState({\n        locked: !this.state.locked\n      }),\n      style: {\n        backgroundColor: this.state.locked ? 'grey' : null\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 465\n      },\n      __self: this\n    }, this.state.locked ? React.createElement(Icon, {\n      name: \"lock\",\n      style: {\n        color: 'white'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475\n      },\n      __self: this\n    }) : React.createElement(Icon, {\n      name: \"unlock\",\n      color: \"grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477\n      },\n      __self: this\n    })), React.createElement(Button, {\n      onClick: () => this.saveTrame(),\n      color: \"red\",\n      disabled: this.state.taskListAvant.length + this.state.taskListPendant.length + this.state.taskListAprès.length === 0,\n      icon: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 480\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"save\",\n      color: \"white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 491\n      },\n      __self: this\n    }))))), React.createElement(\"div\", {\n      style: {\n        flex: 10,\n        overflowY: 'auto',\n        marginTop: 120,\n        width: '100%'\n      },\n      className: \"hidescrollbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497\n      },\n      __self: this\n    }, React.createElement(TrameList, {\n      visite: this.props.visite,\n      locked: this.state.locked,\n      activeIndex: this.props.index,\n      handleChangeIndex: this.props.handleChangeIndex,\n      onDragEnd: this.onDragEnd,\n      validateName: this.validateName,\n      taskListAvant: this.state.taskListAvant,\n      taskListPendant: this.state.taskListPendant,\n      taskListAprès: this.state.taskListAprès,\n      changeType: this.changeType,\n      handleTextChange: this.handleTextChange,\n      deleteTask: this.deleteTask,\n      addDocument: this.addDocument,\n      deleteDocument: this.deleteDocument,\n      visiteTrame: true,\n      addForm: this.addForm,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507\n      },\n      __self: this\n    }))))));\n  }\n\n}\n\nEditComponent.propTypes = {\n  trame: PropTypes.object,\n  index: PropTypes.number\n};\nexport default EditComponent;","map":{"version":3,"sources":["/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/trame/edit.js"],"names":["React","Container","Button","Icon","Responsive","PropTypes","PouchDBServices","TrameList","EditComponent","Component","constructor","props","handleChange","event","value","setState","activeIndex","handleChangeIndex","onDragEnd","result","destination","source","droppableId","index","taskList","state","taskListAvant","taskListPendant","taskListAprès","res","Array","from","splice","removed","trame","trameAvant","tramePendant","trameAprès","calculateIndex","id","isLoading","_id","_rev","visite","locked","validateName","bind","changeType","handleTextChange","handleNameChange","deleteTask","addDocument","deleteDocument","addForm","saveTrame","window","confirm","services","updateTrame","closeEdit","e","console","log","task","filter","t","innerContent","Math","max","length","parseInt","apply","map","o","file","name","title","data","trameName","text","type","addTask","render","display","height","width","backgroundColor","overflow","justifyContent","textAlign","flexDirection","alignItems","position","zIndex","padding","flex","marginLeft","color","overflowY","marginTop","propTypes","object","number"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,EAAoBC,MAApB,EAA4BC,IAA5B,EAAkCC,UAAlC,QAAoD,mBAApD;AACA,SAASC,SAAT,QAA0B,YAA1B;AAEA,OAAOC,eAAP,MAA4B,yBAA5B;AAEA,OAAOC,SAAP,MAAsB,mCAAtB;;AAEA,MAAMC,aAAN,SAA4BR,KAAK,CAACS,SAAlC,CAA4C;AAC1CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAoQnBC,YApQmB,GAoQJ,CAACC,KAAD,EAAQC,KAAR,KAAkB;AAC/B,WAAKC,QAAL,CAAc;AACZC,QAAAA,WAAW,EAAEF;AADD,OAAd;AAGD,KAxQkB;;AAAA,SA0QnBG,iBA1QmB,GA0QCH,KAAK,IAAI;AAC3B,WAAKC,QAAL,CAAc;AACZC,QAAAA,WAAW,EAAEF;AADD,OAAd;AAGD,KA9QkB;;AAAA,SAiWnBI,SAjWmB,GAiWPC,MAAM,IAAI;AAAA,YACZC,WADY,GACYD,MADZ,CACZC,WADY;AAAA,YACCC,MADD,GACYF,MADZ,CACCE,MADD;;AAGpB,UAAI,CAACD,WAAL,EAAkB;AAChB;AACD;;AAED,UACEA,WAAW,CAACE,WAAZ,KAA4BD,MAAM,CAACC,WAAnC,IACAF,WAAW,CAACG,KAAZ,KAAsBF,MAAM,CAACE,KAF/B,EAGE;AACA;AACD;;AAED,UAAIC,QAAJ;AACA,WAAKb,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACKC,QAAQ,GAAG,KAAKC,KAAL,CAAWC,aAD3B,GAEI,KAAKf,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACCC,QAAQ,GAAG,KAAKC,KAAL,CAAWE,eADvB,GAECH,QAAQ,GAAG,KAAKC,KAAL,CAAWG,aAJ3B;AAMA,YAAMC,GAAG,GAAGC,KAAK,CAACC,IAAN,CAAWP,QAAX,CAAZ;;AArBoB,0BAuBFK,GAAG,CAACG,MAAJ,CAAWb,MAAM,CAACE,MAAP,CAAcE,KAAzB,EAAgC,CAAhC,CAvBE;AAAA;AAAA,YAuBbU,OAvBa;;AAwBpBJ,MAAAA,GAAG,CAACG,MAAJ,CAAWb,MAAM,CAACC,WAAP,CAAmBG,KAA9B,EAAqC,CAArC,EAAwCU,OAAxC;AAEA,WAAKtB,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AAAEW,QAAAA,aAAa,EAAEG;AAAjB,OAAd,CADJ,GAEI,KAAKlB,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AAAEY,QAAAA,eAAe,EAAEE;AAAnB,OAAd,CADA,GAEA,KAAKd,QAAL,CAAc;AAAEa,QAAAA,aAAa,EAAEC;AAAjB,OAAd,CAJJ;AAKD,KAhYkB;;AAEjB,SAAKJ,KAAL,GAAa;AACXC,MAAAA,aAAa,EAAE,KAAKf,KAAL,CAAWuB,KAAX,CAAiBC,UADrB;AAEXR,MAAAA,eAAe,EAAE,KAAKhB,KAAL,CAAWuB,KAAX,CAAiBE,YAFvB;AAGXR,MAAAA,aAAa,EAAE,KAAKjB,KAAL,CAAWuB,KAAX,CAAiBG,UAHrB;AAIXrB,MAAAA,WAAW,EAAE,CAJF;AAKXO,MAAAA,KAAK,EAAE,KAAKe,cAAL,EALI;AAMXC,MAAAA,EAAE,EAAE,KAAKD,cAAL,EANO;AAOXE,MAAAA,SAAS,EAAE,IAPA;AAQXC,MAAAA,GAAG,EAAE,KAAK9B,KAAL,CAAWuB,KAAX,CAAiBO,GARX;AASXC,MAAAA,IAAI,EAAE,KAAK/B,KAAL,CAAWgC,MAAX,CAAkBD,IATb;AAUXE,MAAAA,MAAM,EAAE;AAVG,KAAb;AAYA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,UAAL,GAAkB,KAAKA,UAAL,CAAgBD,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAKE,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBF,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKG,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBH,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKI,UAAL,GAAkB,KAAKA,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAKK,WAAL,GAAmB,KAAKA,WAAL,CAAiBL,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKM,cAAL,GAAsB,KAAKA,cAAL,CAAoBN,IAApB,CAAyB,IAAzB,CAAtB;AACA,SAAKO,OAAL,GAAe,KAAKA,OAAL,CAAaP,IAAb,CAAkB,IAAlB,CAAf;AACD;;AAED,QAAMQ,SAAN,GAAkB;AAChB,QAAIC,MAAM,CAACC,OAAP,CAAe,sCAAf,CAAJ,EAA4D;AAC1D,UAAI;AACF,cAAMlD,eAAe,CAACmD,QAAhB,CAAyBd,MAAzB,CAAgCe,WAAhC,CACJ,KAAK/C,KAAL,CAAWgC,MADP,EAEJ,KAAKlB,KAAL,CAAWiB,IAFP,oBAIC,KAAK/B,KAAL,CAAWuB,KAJZ;AAKFC,UAAAA,UAAU,EAAE,KAAKV,KAAL,CAAWC,aALrB;AAMFU,UAAAA,YAAY,EAAE,KAAKX,KAAL,CAAWE,eANvB;AAOFU,UAAAA,UAAU,EAAE,KAAKZ,KAAL,CAAWG;AAPrB,WAAN;AAWA,aAAKjB,KAAL,CAAWgD,SAAX;AACD,OAbD,CAaE,OAAOC,CAAP,EAAU;AACVC,QAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD;AACF;AACF;;AAEDP,EAAAA,OAAO,CAACU,IAAD,EAAO;AACZ,SAAKtC,KAAL,CAAWT,WAAX,KAA2B,CAA3B,GACI,KAAKD,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiB,SAAjB;AACD;;AAED,eAAOD,CAAP;AACD,OANc;AADH,KAAd,CADJ,GAUI,KAAKxC,KAAL,CAAWT,WAAX,KAA2B,CAA3B,GACA,KAAKD,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiB,SAAjB;AACD;;AAED,eAAOD,CAAP;AACD,OANgB;AADL,KAAd,CADA,GAUA,KAAKlD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiB,SAAjB;AACD;;AAED,eAAOD,CAAP;AACD,OANc;AADH,KAAd,CApBJ;AA6BD;;AAED3B,EAAAA,cAAc,GAAG;AACf,WACE6B,IAAI,CAACC,GAAL,CACE,KAAKzD,KAAL,CAAWuB,KAAX,CAAiBC,UAAjB,CAA4BkC,MAA5B,KAAuC,CAAvC,GACI,CADJ,GAEIC,QAAQ,CACNH,IAAI,CAACC,GAAL,CAASG,KAAT,CACEJ,IADF,EAEE,KAAKxD,KAAL,CAAWuB,KAAX,CAAiBC,UAAjB,CAA4BqC,GAA5B,CAAgC,UAASC,CAAT,EAAY;AAC1C,aAAOA,CAAC,CAAClD,KAAT;AACD,KAFD,CAFF,CADM,CAHd,EAWE,KAAKZ,KAAL,CAAWuB,KAAX,CAAiBE,YAAjB,CAA8BiC,MAA9B,KAAyC,CAAzC,GACI,CADJ,GAEIC,QAAQ,CACNH,IAAI,CAACC,GAAL,CAASG,KAAT,CACEJ,IADF,EAEE,KAAKxD,KAAL,CAAWuB,KAAX,CAAiBE,YAAjB,CAA8BoC,GAA9B,CAAkC,UAASC,CAAT,EAAY;AAC5C,aAAOA,CAAC,CAAClD,KAAT;AACD,KAFD,CAFF,CADM,CAbd,EAqBE,KAAKZ,KAAL,CAAWuB,KAAX,CAAiBG,UAAjB,CAA4BgC,MAA5B,KAAuC,CAAvC,GACI,CADJ,GAEIC,QAAQ,CACNH,IAAI,CAACC,GAAL,CAASG,KAAT,CACEJ,IADF,EAEE,KAAKxD,KAAL,CAAWuB,KAAX,CAAiBG,UAAjB,CAA4BmC,GAA5B,CAAgC,UAASC,CAAT,EAAY;AAC1C,aAAOA,CAAC,CAAClD,KAAT;AACD,KAFD,CAFF,CADM,CAvBd,IA+BI,CAhCN;AAkCD;;AAED2B,EAAAA,UAAU,CAACa,IAAD,EAAO;AACf,SAAKpD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,eAAOA,CAAC,IAAIF,IAAZ;AACD,OAFc;AADH,KAAd,CADJ,GAMI,KAAKpD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,eAAOA,CAAC,IAAIF,IAAZ;AACD,OAFgB;AADL,KAAd,CADA,GAMA,KAAKhD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,eAAOA,CAAC,IAAIF,IAAZ;AACD,OAFc;AADH,KAAd,CAZJ;AAiBD;;AAEDZ,EAAAA,WAAW,CAACY,IAAD,EAAOW,IAAP,EAAa;AACtB,SAAK/D,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiBQ,IAAjB;AACD;;AACD,eAAOT,CAAP;AACD,OALc;AADH,KAAd,CADJ,GASI,KAAKtD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiBQ,IAAjB;AACD;;AACD,eAAOT,CAAP;AACD,OALgB;AADL,KAAd,CADA,GASA,KAAKlD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiBQ,IAAjB;AACD;;AACD,eAAOT,CAAP;AACD,OALc;AADH,KAAd,CAlBJ;AA0BD;;AAEDb,EAAAA,cAAc,CAACW,IAAD,EAAO;AACnB,SAAKpD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiB,EAAjB;AACD;;AACD,eAAOD,CAAP;AACD,OALc;AADH,KAAd,CADJ,GASI,KAAKtD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiB,EAAjB;AACD;;AACD,eAAOD,CAAP;AACD,OALgB;AADL,KAAd,CADA,GASA,KAAKlD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiB,EAAjB;AACD;;AACD,eAAOD,CAAP;AACD,OALc;AADH,KAAd,CAlBJ;AA0BD;;AAEDpB,EAAAA,YAAY,CAACkB,IAAD,EAAOY,IAAP,EAAa;AACvB,SAAKhE,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACW,KAAF,GAAUD,IAAV;AACD;;AAED,eAAOV,CAAP;AACD,OANc;AADH,KAAd,CADJ,GAUI,KAAKtD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACW,KAAF,GAAUD,IAAV;AACD;;AAED,eAAOV,CAAP;AACD,OANgB;AADL,KAAd,CADA,GAUA,KAAKlD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACW,KAAF,GAAUD,IAAV;AACD;;AAED,eAAOV,CAAP;AACD,OANc;AADH,KAAd,CApBJ;AA6BD;;AAEDhB,EAAAA,gBAAgB,CAACW,CAAD,EAAIiB,IAAJ,EAAU;AACxB,SAAK9D,QAAL,CAAc;AAAE+D,MAAAA,SAAS,EAAED,IAAI,CAAC/D;AAAlB,KAAd;AACD;;AAEDkC,EAAAA,gBAAgB,CAACe,IAAD,EAAOgB,IAAP,EAAa;AAC3B,SAAKpE,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiBa,IAAjB;AACD;;AAED,eAAOd,CAAP;AACD,OANc;AADH,KAAd,CADJ,GAUI,KAAKtD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiBa,IAAjB;AACD;;AAED,eAAOd,CAAP;AACD,OANgB;AADL,KAAd,CADA,GAUA,KAAKlD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACC,YAAF,GAAiBa,IAAjB;AACD;;AAED,eAAOd,CAAP;AACD,OANc;AADH,KAAd,CApBJ;AA6BD;;AAcDlB,EAAAA,UAAU,CAACgB,IAAD,EAAOiB,IAAP,EAAa;AACrB,SAAKrE,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,KAAKD,KAAL,CAAWC,aAAX,CAAyBsC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACe,IAAF,GAASA,IAAT;AACD;;AAED,eAAOf,CAAP;AACD,OANc;AADH,KAAd,CADJ,GAUI,KAAKtD,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,KAAKF,KAAL,CAAWE,eAAX,CAA2BqC,MAA3B,CAAkCC,CAAC,IAAI;AACtD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACe,IAAF,GAASA,IAAT;AACD;;AAED,eAAOf,CAAP;AACD,OANgB;AADL,KAAd,CADA,GAUA,KAAKlD,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,KAAKH,KAAL,CAAWG,aAAX,CAAyBoC,MAAzB,CAAgCC,CAAC,IAAI;AAClD,YAAIA,CAAC,IAAIF,IAAT,EAAe;AACbE,UAAAA,CAAC,CAACe,IAAF,GAASA,IAAT;AACD;;AAED,eAAOf,CAAP;AACD,OANc;AADH,KAAd,CApBJ;AA6BD;;AAEDgB,EAAAA,OAAO,GAAG;AACR;AAEA,SAAKtE,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACI,KAAKR,QAAL,CAAc;AACZW,MAAAA,aAAa,EAAE,CACb,GAAG,KAAKD,KAAL,CAAWC,aADD,EAEb;AACEkD,QAAAA,KAAK,EAAE,mBAAmB,KAAKnD,KAAL,CAAWF,KADvC;AAEEyD,QAAAA,IAAI,EAAE,OAFR;AAGEd,QAAAA,YAAY,EAAE,EAHhB;AAIE3C,QAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWF,KAJpB;AAKEgB,QAAAA,EAAE,EAAE,KAAKd,KAAL,CAAWc;AALjB,OAFa,CADH;AAWZhB,MAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWF,KAAX,GAAmB,CAXd;AAYZgB,MAAAA,EAAE,EAAE,KAAKd,KAAL,CAAWc,EAAX,GAAgB;AAZR,KAAd,CADJ,GAeI,KAAK5B,KAAL,CAAWY,KAAX,KAAqB,CAArB,GACA,KAAKR,QAAL,CAAc;AACZY,MAAAA,eAAe,EAAE,CACf,GAAG,KAAKF,KAAL,CAAWE,eADC,EAEf;AACEiD,QAAAA,KAAK,EAAE,mBAAmB,KAAKnD,KAAL,CAAWF,KADvC;AAEEyD,QAAAA,IAAI,EAAE,OAFR;AAGEd,QAAAA,YAAY,EAAE,EAHhB;AAIE3C,QAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWF,KAJpB;AAKEgB,QAAAA,EAAE,EAAE,KAAKd,KAAL,CAAWc;AALjB,OAFe,CADL;AAWZhB,MAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWF,KAAX,GAAmB,CAXd;AAYZgB,MAAAA,EAAE,EAAE,KAAKd,KAAL,CAAWc,EAAX,GAAgB;AAZR,KAAd,CADA,GAeA,KAAKxB,QAAL,CAAc;AACZa,MAAAA,aAAa,EAAE,CACb,GAAG,KAAKH,KAAL,CAAWG,aADD,EAEb;AACEgD,QAAAA,KAAK,EAAE,mBAAmB,KAAKnD,KAAL,CAAWF,KADvC;AAEEyD,QAAAA,IAAI,EAAE,OAFR;AAGEd,QAAAA,YAAY,EAAE,EAHhB;AAIE3C,QAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWF,KAJpB;AAKEgB,QAAAA,EAAE,EAAE,KAAKd,KAAL,CAAWc;AALjB,OAFa,CADH;AAWZhB,MAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWF,KAAX,GAAmB,CAXd;AAYZgB,MAAAA,EAAE,EAAE,KAAKd,KAAL,CAAWc,EAAX,GAAgB;AAZR,KAAd,CA9BJ;AA4CD;;AAmCD2C,EAAAA,MAAM,GAAG;AACP,WACE;AACE,MAAA,SAAS,EAAC,eADZ;AAEE,MAAA,KAAK,EAAE;AACLC,QAAAA,OAAO,EAAE,MADJ;AAELC,QAAAA,MAAM,EAAE,MAFH;AAGLC,QAAAA,KAAK,EAAE,MAHF;AAKLC,QAAAA,eAAe,EAAE,SALZ;AAMLC,QAAAA,QAAQ,EAAE;AANL,OAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWE;AACE,MAAA,KAAK,EAAE;AACLF,QAAAA,KAAK,EAAE,MADF;AAELG,QAAAA,cAAc,EAAE,QAFX;AAGLC,QAAAA,SAAS,EAAE;AAHN,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOE,oBAAC,SAAD;AAAW,MAAA,KAAK,EAAE;AAAEL,QAAAA,MAAM,EAAE;AAAV,OAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,KAAK,EAAE;AACLD,QAAAA,OAAO,EAAE,MADJ;AAELO,QAAAA,aAAa,EAAE,QAFV;AAGLC,QAAAA,UAAU,EAAE,QAHP;AAILJ,QAAAA,QAAQ,EAAE,QAJL;AAKLH,QAAAA,MAAM,EAAE;AALH,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OASE;AACE,MAAA,KAAK,EAAE;AACLQ,QAAAA,QAAQ,EAAE,OADL;AAELC,QAAAA,MAAM,EAAE,EAFH;AAGLR,QAAAA,KAAK,EAAE,MAHF;AAILC,QAAAA,eAAe,EAAE,SAJZ;AAKLH,QAAAA,OAAO,EAAE,MALJ;AAMLO,QAAAA,aAAa,EAAE,QANV;AAQLI,QAAAA,OAAO,EAAE;AARJ,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAYE;AAAK,MAAA,KAAK,EAAE;AAAEX,QAAAA,OAAO,EAAE,MAAX;AAAmBO,QAAAA,aAAa,EAAE;AAAlC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,UAAD;AAAY,MAAA,QAAQ,EAAE,GAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,KAAK,EAAE;AAAEK,QAAAA,IAAI,EAAE;AAAR,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,EAIE;AACE,MAAA,KAAK,EAAE;AACLA,QAAAA,IAAI,EAAE,CADD;AAELZ,QAAAA,OAAO,EAAE,MAFJ;AAGLK,QAAAA,cAAc,EAAE;AAHX,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOE,oBAAC,MAAD;AACE,MAAA,KAAK,EAAE;AAAEQ,QAAAA,UAAU,EAAE;AAAd,OADT;AAEE,MAAA,KAAK,EAAC,MAFR;AAGE,MAAA,IAAI,MAHN;AAIE,MAAA,OAAO,EAAE,MAAM,KAAKf,OAAL,EAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAkB,MAAA,KAAK,EAAC,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,CAPF,CAJF,EAoBE;AACE,MAAA,KAAK,EAAE;AACLc,QAAAA,IAAI,EAAE,CADD;AAELP,QAAAA,cAAc,EAAE,UAFX;AAGLL,QAAAA,OAAO,EAAE;AAHJ,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOE,oBAAC,MAAD;AACE,MAAA,IAAI,MADN;AAEE,MAAA,OAAO,EAAE,MACP,KAAKpE,QAAL,CAAc;AAAE6B,QAAAA,MAAM,EAAE,CAAC,KAAKnB,KAAL,CAAWmB;AAAtB,OAAd,CAHJ;AAKE,MAAA,KAAK,EAAE;AACL0C,QAAAA,eAAe,EAAE,KAAK7D,KAAL,CAAWmB,MAAX,GAAoB,MAApB,GAA6B;AADzC,OALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OASG,KAAKnB,KAAL,CAAWmB,MAAX,GACC,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAkB,MAAA,KAAK,EAAE;AAAEqD,QAAAA,KAAK,EAAE;AAAT,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,GAGC,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,QAAX;AAAoB,MAAA,KAAK,EAAC,MAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZJ,CAPF,EAsBE,oBAAC,MAAD;AACE,MAAA,OAAO,EAAE,MAAM,KAAK3C,SAAL,EADjB;AAEE,MAAA,KAAK,EAAC,KAFR;AAGE,MAAA,QAAQ,EACN,KAAK7B,KAAL,CAAWC,aAAX,CAAyB2C,MAAzB,GACE,KAAK5C,KAAL,CAAWE,eAAX,CAA2B0C,MAD7B,GAEE,KAAK5C,KAAL,CAAWG,aAAX,CAAyByC,MAF3B,KAGA,CAPJ;AASE,MAAA,IAAI,MATN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAkB,MAAA,KAAK,EAAC,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,CAtBF,CApBF,CAZF,CATF,EAgFE;AACE,MAAA,KAAK,EAAE;AACL0B,QAAAA,IAAI,EAAE,EADD;AAELG,QAAAA,SAAS,EAAE,MAFN;AAGLC,QAAAA,SAAS,EAAE,GAHN;AAKLd,QAAAA,KAAK,EAAE;AALF,OADT;AAQE,MAAA,SAAS,EAAC,eARZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAUE,oBAAC,SAAD;AACE,MAAA,MAAM,EAAE,KAAK1E,KAAL,CAAWgC,MADrB;AAEE,MAAA,MAAM,EAAE,KAAKlB,KAAL,CAAWmB,MAFrB;AAGE,MAAA,WAAW,EAAE,KAAKjC,KAAL,CAAWY,KAH1B;AAIE,MAAA,iBAAiB,EAAE,KAAKZ,KAAL,CAAWM,iBAJhC;AAKE,MAAA,SAAS,EAAE,KAAKC,SALlB;AAME,MAAA,YAAY,EAAE,KAAK2B,YANrB;AAOE,MAAA,aAAa,EAAE,KAAKpB,KAAL,CAAWC,aAP5B;AAQE,MAAA,eAAe,EAAE,KAAKD,KAAL,CAAWE,eAR9B;AASE,MAAA,aAAa,EAAE,KAAKF,KAAL,CAAWG,aAT5B;AAUE,MAAA,UAAU,EAAE,KAAKmB,UAVnB;AAWE,MAAA,gBAAgB,EAAE,KAAKC,gBAXzB;AAYE,MAAA,UAAU,EAAE,KAAKE,UAZnB;AAaE,MAAA,WAAW,EAAE,KAAKC,WAbpB;AAcE,MAAA,cAAc,EAAE,KAAKC,cAdvB;AAeE,MAAA,WAAW,EAAE,IAff;AAgBE,MAAA,OAAO,EAAE,KAAKC,OAhBhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAVF,CAhFF,CADF,CAPF,CAXF,CADF;AAsID;;AA1gByC;;AA6gB5C7C,aAAa,CAAC4F,SAAd,GAA0B;AACxBlE,EAAAA,KAAK,EAAE7B,SAAS,CAACgG,MADO;AAExB9E,EAAAA,KAAK,EAAElB,SAAS,CAACiG;AAFO,CAA1B;AAKA,eAAe9F,aAAf","sourcesContent":["import React from 'react';\nimport { Container, Button, Icon, Responsive } from 'semantic-ui-react';\nimport { PropTypes } from 'prop-types';\n\nimport PouchDBServices from '../../../services/index';\n\nimport TrameList from '../../preferences/trame/trameList';\n\nclass EditComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      taskListAvant: this.props.trame.trameAvant,\n      taskListPendant: this.props.trame.tramePendant,\n      taskListAprès: this.props.trame.trameAprès,\n      activeIndex: 0,\n      index: this.calculateIndex(),\n      id: this.calculateIndex(),\n      isLoading: true,\n      _id: this.props.trame._id,\n      _rev: this.props.visite._rev,\n      locked: false\n    };\n    this.validateName = this.validateName.bind(this);\n    this.changeType = this.changeType.bind(this);\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleNameChange = this.handleNameChange.bind(this);\n    this.deleteTask = this.deleteTask.bind(this);\n    this.addDocument = this.addDocument.bind(this);\n    this.deleteDocument = this.deleteDocument.bind(this);\n    this.addForm = this.addForm.bind(this);\n  }\n\n  async saveTrame() {\n    if (window.confirm('Voulez-vous sauvegarder cette trame?')) {\n      try {\n        await PouchDBServices.services.visite.updateTrame(\n          this.props.visite,\n          this.state._rev,\n          {\n            ...this.props.trame,\n            trameAvant: this.state.taskListAvant,\n            tramePendant: this.state.taskListPendant,\n            trameAprès: this.state.taskListAprès\n          }\n        );\n\n        this.props.closeEdit();\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }\n\n  addForm(task) {\n    this.state.activeIndex === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            if (t == task) {\n              t.innerContent = 'form1&9';\n            }\n\n            return t;\n          })\n        })\n      : this.state.activeIndex === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            if (t == task) {\n              t.innerContent = 'form1&9';\n            }\n\n            return t;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            if (t == task) {\n              t.innerContent = 'form1&9';\n            }\n\n            return t;\n          })\n        });\n  }\n\n  calculateIndex() {\n    return (\n      Math.max(\n        this.props.trame.trameAvant.length === 0\n          ? 0\n          : parseInt(\n              Math.max.apply(\n                Math,\n                this.props.trame.trameAvant.map(function(o) {\n                  return o.index;\n                })\n              )\n            ),\n        this.props.trame.tramePendant.length === 0\n          ? 0\n          : parseInt(\n              Math.max.apply(\n                Math,\n                this.props.trame.tramePendant.map(function(o) {\n                  return o.index;\n                })\n              )\n            ),\n        this.props.trame.trameAprès.length === 0\n          ? 0\n          : parseInt(\n              Math.max.apply(\n                Math,\n                this.props.trame.trameAprès.map(function(o) {\n                  return o.index;\n                })\n              )\n            )\n      ) + 1\n    );\n  }\n\n  deleteTask(task) {\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            return t != task;\n          })\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            return t != task;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            return t != task;\n          })\n        });\n  }\n\n  addDocument(task, file) {\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            if (t == task) {\n              t.innerContent = file;\n            }\n            return t;\n          })\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            if (t == task) {\n              t.innerContent = file;\n            }\n            return t;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            if (t == task) {\n              t.innerContent = file;\n            }\n            return t;\n          })\n        });\n  }\n\n  deleteDocument(task) {\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            if (t == task) {\n              t.innerContent = '';\n            }\n            return t;\n          })\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            if (t == task) {\n              t.innerContent = '';\n            }\n            return t;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            if (t == task) {\n              t.innerContent = '';\n            }\n            return t;\n          })\n        });\n  }\n\n  validateName(task, name) {\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            if (t == task) {\n              t.title = name;\n            }\n\n            return t;\n          })\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            if (t == task) {\n              t.title = name;\n            }\n\n            return t;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            if (t == task) {\n              t.title = name;\n            }\n\n            return t;\n          })\n        });\n  }\n\n  handleNameChange(e, data) {\n    this.setState({ trameName: data.value });\n  }\n\n  handleTextChange(task, text) {\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            if (t == task) {\n              t.innerContent = text;\n            }\n\n            return t;\n          })\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            if (t == task) {\n              t.innerContent = text;\n            }\n\n            return t;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            if (t == task) {\n              t.innerContent = text;\n            }\n\n            return t;\n          })\n        });\n  }\n\n  handleChange = (event, value) => {\n    this.setState({\n      activeIndex: value\n    });\n  };\n\n  handleChangeIndex = value => {\n    this.setState({\n      activeIndex: value\n    });\n  };\n\n  changeType(task, type) {\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: this.state.taskListAvant.filter(t => {\n            if (t == task) {\n              t.type = type;\n            }\n\n            return t;\n          })\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: this.state.taskListPendant.filter(t => {\n            if (t == task) {\n              t.type = type;\n            }\n\n            return t;\n          })\n        })\n      : this.setState({\n          taskListAprès: this.state.taskListAprès.filter(t => {\n            if (t == task) {\n              t.type = type;\n            }\n\n            return t;\n          })\n        });\n  }\n\n  addTask() {\n    //de 3 types: basic, text, ou document.\n\n    this.props.index === 0\n      ? this.setState({\n          taskListAvant: [\n            ...this.state.taskListAvant,\n            {\n              title: 'Nouvelle tâche' + this.state.index,\n              type: 'basic',\n              innerContent: '',\n              index: this.state.index,\n              id: this.state.id\n            }\n          ],\n          index: this.state.index + 1,\n          id: this.state.id + 1\n        })\n      : this.props.index === 1\n      ? this.setState({\n          taskListPendant: [\n            ...this.state.taskListPendant,\n            {\n              title: 'Nouvelle tâche' + this.state.index,\n              type: 'basic',\n              innerContent: '',\n              index: this.state.index,\n              id: this.state.id\n            }\n          ],\n          index: this.state.index + 1,\n          id: this.state.id + 1\n        })\n      : this.setState({\n          taskListAprès: [\n            ...this.state.taskListAprès,\n            {\n              title: 'Nouvelle tâche' + this.state.index,\n              type: 'basic',\n              innerContent: '',\n              index: this.state.index,\n              id: this.state.id\n            }\n          ],\n          index: this.state.index + 1,\n          id: this.state.id + 1\n        });\n  }\n\n  onDragEnd = result => {\n    const { destination, source } = result;\n\n    if (!destination) {\n      return;\n    }\n\n    if (\n      destination.droppableId === source.droppableId &&\n      destination.index === source.index\n    ) {\n      return;\n    }\n\n    let taskList;\n    this.props.index === 0\n      ? (taskList = this.state.taskListAvant)\n      : this.props.index === 1\n      ? (taskList = this.state.taskListPendant)\n      : (taskList = this.state.taskListAprès);\n\n    const res = Array.from(taskList);\n\n    const [removed] = res.splice(result.source.index, 1);\n    res.splice(result.destination.index, 0, removed);\n\n    this.props.index === 0\n      ? this.setState({ taskListAvant: res })\n      : this.props.index === 1\n      ? this.setState({ taskListPendant: res })\n      : this.setState({ taskListAprès: res });\n  };\n\n  render() {\n    return (\n      <div\n        className=\"hidescrollbar\"\n        style={{\n          display: 'flex',\n          height: '100%',\n          width: '100%',\n\n          backgroundColor: '#f2f2f2',\n          overflow: 'hidden'\n        }}\n      >\n        <div\n          style={{\n            width: '100%',\n            justifyContent: 'center',\n            textAlign: 'center'\n          }}\n        >\n          <Container style={{ height: '100%' }}>\n            <div\n              style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                overflow: 'hidden',\n                height: '100%'\n              }}\n            >\n              <div\n                style={{\n                  position: 'fixed',\n                  zIndex: 10,\n                  width: '100%',\n                  backgroundColor: '#f2f2f2',\n                  display: 'flex',\n                  flexDirection: 'column',\n\n                  padding: 20\n                }}\n              >\n                <div style={{ display: 'flex', flexDirection: 'row' }}>\n                  <Responsive minWidth={400}>\n                    <div style={{ flex: 0.3 }}></div>\n                  </Responsive>\n                  <div\n                    style={{\n                      flex: 1,\n                      display: 'flex',\n                      justifyContent: 'flex-end'\n                    }}\n                  >\n                    <Button\n                      style={{ marginLeft: 5 }}\n                      color=\"teal\"\n                      icon\n                      onClick={() => this.addTask()}\n                    >\n                      <Icon name=\"plus\" color=\"white\"></Icon>\n                    </Button>\n                  </div>\n                  <div\n                    style={{\n                      flex: 1,\n                      justifyContent: 'flex-end',\n                      display: 'flex'\n                    }}\n                  >\n                    <Button\n                      icon\n                      onClick={() =>\n                        this.setState({ locked: !this.state.locked })\n                      }\n                      style={{\n                        backgroundColor: this.state.locked ? 'grey' : null\n                      }}\n                    >\n                      {this.state.locked ? (\n                        <Icon name=\"lock\" style={{ color: 'white' }}></Icon>\n                      ) : (\n                        <Icon name=\"unlock\" color=\"grey\"></Icon>\n                      )}\n                    </Button>\n                    <Button\n                      onClick={() => this.saveTrame()}\n                      color=\"red\"\n                      disabled={\n                        this.state.taskListAvant.length +\n                          this.state.taskListPendant.length +\n                          this.state.taskListAprès.length ===\n                        0\n                      }\n                      icon\n                    >\n                      <Icon name=\"save\" color=\"white\"></Icon>\n                    </Button>\n                  </div>\n                </div>\n              </div>\n\n              <div\n                style={{\n                  flex: 10,\n                  overflowY: 'auto',\n                  marginTop: 120,\n\n                  width: '100%'\n                }}\n                className=\"hidescrollbar\"\n              >\n                <TrameList\n                  visite={this.props.visite}\n                  locked={this.state.locked}\n                  activeIndex={this.props.index}\n                  handleChangeIndex={this.props.handleChangeIndex}\n                  onDragEnd={this.onDragEnd}\n                  validateName={this.validateName}\n                  taskListAvant={this.state.taskListAvant}\n                  taskListPendant={this.state.taskListPendant}\n                  taskListAprès={this.state.taskListAprès}\n                  changeType={this.changeType}\n                  handleTextChange={this.handleTextChange}\n                  deleteTask={this.deleteTask}\n                  addDocument={this.addDocument}\n                  deleteDocument={this.deleteDocument}\n                  visiteTrame={true}\n                  addForm={this.addForm}\n                />\n              </div>\n            </div>\n          </Container>\n        </div>\n      </div>\n    );\n  }\n}\n\nEditComponent.propTypes = {\n  trame: PropTypes.object,\n  index: PropTypes.number\n};\n\nexport default EditComponent;\n"]},"metadata":{},"sourceType":"module"}