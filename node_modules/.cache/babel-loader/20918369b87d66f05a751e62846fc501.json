{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/antoine/Documents/DGCCRF/dgccrf-front/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/photo/photo.js\";\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n  animation: 1s \", \";\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\", \"\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from 'react';\nimport Camera, { FACING_MODES } from 'react-html5-camera-photo';\nimport 'react-html5-camera-photo/build/css/index.css';\nimport './photo.css';\nimport styled, { keyframes } from 'styled-components';\nimport { slideInUp } from 'react-animations';\nimport FullScreen from 'react-full-screen';\nimport { Spinner } from 'react-activity';\nimport 'react-activity/dist/react-activity.css';\nimport { Icon } from 'semantic-ui-react';\nimport { Button } from '@material-ui/core';\nimport Jimp from 'jimp';\nimport { Buffer } from 'buffer';\nconst SlideAnimation = keyframes(_templateObject(), slideInUp);\nconst SlideDiv = styled.div(_templateObject2(), SlideAnimation);\nexport default class Photo extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.goFull = () => {\n      this.setState({\n        isFull: !this.state.isFull\n      });\n    };\n\n    this.close = () => {\n      this.props.setActiveTab(0);\n      this.goFull();\n    };\n\n    this.loaded = () => {\n      this.setState({\n        loaded: true\n      });\n    };\n\n    this.getFileSize = dataUri => {\n      console.log(dataUri);\n      const size = dataUri.length * (3 / 4) - 2;\n      return size;\n    };\n\n    this.reSizeImage = dataUri => new Promise((resolve, reject) => {\n      Jimp.read(Buffer.from(dataUri.replace(/^data:image\\/png;base64,/, ''), 'base64')).then(img => {\n        const n = img.quality(90);\n        n.getBase64(Jimp.MIME_JPEG, (err, res) => {\n          // console.log(this.getFileSize(res));\n          resolve(res);\n        });\n      });\n    });\n\n    this.state = {\n      isFull: false,\n      loaded: false\n    };\n  }\n\n  componentDidMount() {\n    this.goFull();\n  }\n\n  async onTakePhoto(dataUri) {\n    // Do stuff with the dataUri photo...\n    let size = this.getFileSize(dataUri);\n    let img = dataUri;\n\n    while (size > 100000) {\n      img = await this.reSizeImage(dataUri);\n      size = this.getFileSize(img);\n    }\n\n    console.log(this.getFileSize(img));\n    console.log(img);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        backgroundColor: 'black'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, !this.state.loaded && React.createElement(Spinner, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }), React.createElement(FullScreen, {\n      enabled: this.state.isFull,\n      onChange: isFull => this.setState({\n        isFull\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, this.state.isFull && React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'column'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(Camera, {\n      onCameraStart: () => this.loaded(),\n      idealFacingMode: FACING_MODES.ENVIRONMENT,\n      isImageMirror: false,\n      onTakePhoto: dataUri => {\n        this.onTakePhoto(dataUri);\n        this.close();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        marginTop: 50,\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(Button, {\n      size: \"large\",\n      color: \"secondary\",\n      variant: \"outlined\",\n      onClick: () => this.close(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, \"Fermer\")))));\n  }\n\n}","map":{"version":3,"sources":["/Users/antoine/Documents/DGCCRF/dgccrf-front/src/containers/visite/photo/photo.js"],"names":["React","Component","Camera","FACING_MODES","styled","keyframes","slideInUp","FullScreen","Spinner","Icon","Button","Jimp","Buffer","SlideAnimation","SlideDiv","div","Photo","constructor","props","context","goFull","setState","isFull","state","close","setActiveTab","loaded","getFileSize","dataUri","console","log","size","length","reSizeImage","Promise","resolve","reject","read","from","replace","then","img","n","quality","getBase64","MIME_JPEG","err","res","componentDidMount","onTakePhoto","render","backgroundColor","display","flexDirection","ENVIRONMENT","marginTop","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport Camera, { FACING_MODES } from 'react-html5-camera-photo';\n\nimport 'react-html5-camera-photo/build/css/index.css';\n\nimport './photo.css';\n\nimport styled, { keyframes } from 'styled-components';\nimport { slideInUp } from 'react-animations';\n\nimport FullScreen from 'react-full-screen';\n\nimport { Spinner } from 'react-activity';\n\nimport 'react-activity/dist/react-activity.css';\nimport { Icon } from 'semantic-ui-react';\nimport { Button } from '@material-ui/core';\n\nimport Jimp from 'jimp';\n\nimport { Buffer } from 'buffer';\n\nconst SlideAnimation = keyframes`${slideInUp}`;\n\nconst SlideDiv = styled.div`\n  animation: 1s ${SlideAnimation};\n`;\n\nexport default class Photo extends Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      isFull: false,\n      loaded: false\n    };\n  }\n  goFull = () => {\n    this.setState({ isFull: !this.state.isFull });\n  };\n\n  close = () => {\n    this.props.setActiveTab(0);\n    this.goFull();\n  };\n\n  componentDidMount() {\n    this.goFull();\n  }\n\n  loaded = () => {\n    this.setState({ loaded: true });\n  };\n\n  getFileSize = dataUri => {\n    console.log(dataUri);\n    const size = dataUri.length * (3 / 4) - 2;\n    return size;\n  };\n\n  reSizeImage = dataUri =>\n    new Promise((resolve, reject) => {\n      Jimp.read(\n        Buffer.from(dataUri.replace(/^data:image\\/png;base64,/, ''), 'base64')\n      ).then(img => {\n        const n = img.quality(90);\n        n.getBase64(Jimp.MIME_JPEG, (err, res) => {\n          // console.log(this.getFileSize(res));\n          resolve(res);\n        });\n      });\n    });\n\n  async onTakePhoto(dataUri) {\n    // Do stuff with the dataUri photo...\n\n    let size = this.getFileSize(dataUri);\n    let img = dataUri;\n    while (size > 100000) {\n      img = await this.reSizeImage(dataUri);\n      size = this.getFileSize(img);\n    }\n    console.log(this.getFileSize(img));\n    console.log(img);\n  }\n\n  render() {\n    return (\n      <div style={{ backgroundColor: 'black' }}>\n        {!this.state.loaded && <Spinner />}\n        <br />\n        <FullScreen\n          enabled={this.state.isFull}\n          onChange={isFull => this.setState({ isFull })}\n        >\n          {this.state.isFull && (\n            <div\n              style={{\n                display: 'flex',\n                flexDirection: 'column'\n              }}\n            >\n              <Camera\n                onCameraStart={() => this.loaded()}\n                idealFacingMode={FACING_MODES.ENVIRONMENT}\n                isImageMirror={false}\n                onTakePhoto={dataUri => {\n                  this.onTakePhoto(dataUri);\n                  this.close();\n                }}\n              />\n              <div\n                style={{\n                  marginTop: 50,\n\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n              >\n                <Button\n                  size=\"large\"\n                  color=\"secondary\"\n                  variant=\"outlined\"\n                  onClick={() => this.close()}\n                >\n                  Fermer\n                </Button>\n              </div>\n            </div>\n          )}\n        </FullScreen>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}